<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>EuromilhÃµes â€” Gerador Racional</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#3949ab">

<style>
body {
    font-family: system-ui, Arial, sans-serif;
    background: #f5f6fa;
    margin: 0;
    padding: 20px;
}

h1 {
    text-align: center;
    color: #3949ab;
}

button {
    width: 100%;
    padding: 14px;
    margin: 10px 0;
    font-size: 16px;
    background: #3949ab;
    color: #fff;
    border: none;
    border-radius: 8px;
}

.resultado {
    background: #fff;
    border-radius: 8px;
    padding: 15px;
    margin-top: 15px;
}

.chave {
    margin-bottom: 10px;
    padding-bottom: 10px;
    border-bottom: 1px solid #eee;
}
</style>
</head>

<body>

<h1>ðŸŽ¯ EuromilhÃµes â€” Gerador Racional</h1>

<button onclick="gerarUma()">Gerar 1 chave racional</button>
<button onclick="gerarCinco()">Gerar 5 chaves otimizadas</button>

<div id="resultado" class="resultado"></div>

<script>
/* ========= PASSO 2 â€” GERADOR RACIONAL ========= */

function gerarNumero(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
}

function contarConsecutivos(arr) {
    let c = 0;
    for (let i = 1; i < arr.length; i++) {
        if (arr[i] === arr[i - 1] + 1) c++;
    }
    return c;
}

function gerarChaveRacional() {
    while (true) {
        let numeros = new Set();

        while (numeros.size < 5) {
            numeros.add(gerarNumero(1, 50));
        }

        numeros = Array.from(numeros).sort((a, b) => a - b);

        const baixos = numeros.filter(n => n <= 25).length;
        const altos  = numeros.filter(n => n >= 26).length;
        if (baixos < 2 || baixos > 3) continue;
        if (altos  < 2 || altos  > 3) continue;

        const pares = numeros.filter(n => n % 2 === 0).length;
        if (pares === 0 || pares === 5) continue;

        const soma = numeros.reduce((a, b) => a + b, 0);
        if (soma < 115 || soma > 170) continue;

        if (contarConsecutivos(numeros) > 1) continue;

        const estrela1 = gerarNumero(1, 6);
        let estrela2;
        do {
            estrela2 = gerarNumero(7, 12);
        } while (estrela2 === estrela1 + 1);

        return { numeros, estrelas: [estrela1, estrela2] };
    }
}

/* ========= PASSO 3 â€” MÃšLTIPLAS CHAVES ========= */

function intersecao(a, b) {
    return a.filter(n => b.includes(n)).length;
}

function gerarMultiplasChaves(qtd) {
    const chaves = [];
    const maxIntersecao = 2;

    let tentativas = 0;
    while (chaves.length < qtd && tentativas < 1000) {
        const nova = gerarChaveRacional();

        const conflito = chaves.some(chave =>
            intersecao(chave.numeros, nova.numeros) > maxIntersecao
        );

        if (!conflito) chaves.push(nova);
        tentativas++;
    }
    return chaves;
}

/* ========= UI ========= */

function mostrar(chaves) {
    const div = document.getElementById("resultado");
    div.innerHTML = "";

    chaves.forEach((c, i) => {
        const el = document.createElement("div");
        el.className = "chave";
        el.innerHTML = `
            <strong>Chave ${i + 1}</strong><br>
            NÃºmeros: ${c.numeros.join(" ")}<br>
            Estrelas: ${c.estrelas.join(" ")}
        `;
        div.appendChild(el);
    });
}

function gerarUma() {
    mostrar([gerarChaveRacional()]);
}

function gerarCinco() {
    mostrar(gerarMultiplasChaves(5));
}

/* ========= SERVICE WORKER ========= */

if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("sw.js");
}
</script>

</body>
</html>
